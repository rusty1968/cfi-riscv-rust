<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How Hackers Hijack Programs ‚Äî And How CFI Stops Them</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;600;700;800&family=Nunito:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #faf8f4;
  --surface: #ffffff;
  --surface2: #f3f0ea;
  --border: #e4dfd6;
  --border2: #d1cbc0;
  --text: #2c2418;
  --text2: #6b5e4d;
  --text3: #9c8e7a;
  --green: #2a9d6e;
  --green-light: #e8f6ef;
  --green-border: #b4dfc9;
  --red: #c9453a;
  --red-light: #fceae8;
  --red-border: #edb8b3;
  --blue: #3574c4;
  --blue-light: #e8f0fa;
  --amber: #c48a1a;
  --amber-light: #fdf3dc;
  --amber-border: #e8d5a0;
  --purple: #7c52b8;
  --purple-light: #f1ebfa;
  --serif: 'Fraunces', Georgia, serif;
  --sans: 'Nunito', sans-serif;
  --mono: 'IBM Plex Mono', monospace;
}

* { margin:0; padding:0; box-sizing:border-box; }
body { background:var(--bg); color:var(--text); font-family:var(--sans); line-height:1.7; }

.page { max-width:820px; margin:0 auto; padding:48px 24px 80px; }

/* Header */
.hero { text-align:center; margin-bottom:56px; }
.hero .eyebrow {
  font-family:var(--mono); font-size:11px; letter-spacing:2px; text-transform:uppercase;
  color:var(--red); margin-bottom:16px;
}
.hero h1 {
  font-family:var(--serif); font-size:clamp(28px,5vw,44px); font-weight:800;
  line-height:1.15; letter-spacing:-0.5px; color:var(--text); margin-bottom:16px;
}
.hero h1 em { font-style:italic; color:var(--red); }
.hero .intro {
  font-size:16px; color:var(--text2); max-width:560px; margin:0 auto; line-height:1.75;
}

/* Section */
.attack-section {
  margin-bottom:52px;
  padding-bottom:52px;
  border-bottom:1px solid var(--border);
}
.attack-section:last-of-type { border-bottom:none; }

.section-num {
  font-family:var(--mono); font-size:11px; letter-spacing:2px; text-transform:uppercase;
  color:var(--text3); margin-bottom:8px;
}

.attack-section h2 {
  font-family:var(--serif); font-size:26px; font-weight:700; margin-bottom:6px; letter-spacing:-0.3px;
}
.attack-section h2 .emoji { font-style:normal; }
.attack-section .aka {
  font-family:var(--mono); font-size:11px; color:var(--text3); margin-bottom:18px;
}

.attack-section .story {
  font-size:15.5px; color:var(--text2); margin-bottom:24px; line-height:1.8;
}
.attack-section .story strong { color:var(--text); font-weight:700; }

/* Analogy box */
.analogy {
  background:var(--amber-light); border:1px solid var(--amber-border); border-radius:14px;
  padding:22px 26px; margin-bottom:24px; position:relative;
}
.analogy::before {
  content:'üí°'; position:absolute; top:-12px; left:20px;
  font-size:20px; background:var(--amber-light); padding:0 6px;
}
.analogy .label {
  font-family:var(--mono); font-size:10px; letter-spacing:1.5px; text-transform:uppercase;
  color:var(--amber); margin-bottom:8px; font-weight:600;
}
.analogy p { font-size:14.5px; color:var(--text); line-height:1.75; }

/* Visual scene */
.scene {
  background:var(--surface); border:1px solid var(--border); border-radius:16px;
  overflow:hidden; margin-bottom:24px;
}
.scene-header {
  display:flex; gap:8px; padding:14px 20px; border-bottom:1px solid var(--border);
  background:var(--surface2);
}
.scene-dot { width:10px; height:10px; border-radius:50%; }

.scene-body { padding:24px; }

/* Flow diagram inside scene */
.flow {
  display:flex; align-items:center; gap:12px; flex-wrap:wrap; justify-content:center;
}
.flow-step {
  background:var(--surface2); border:1px solid var(--border); border-radius:12px;
  padding:16px 18px; text-align:center; min-width:130px; max-width:180px;
  flex:0 0 auto; transition:all 0.3s;
}
.flow-step .icon { font-size:28px; margin-bottom:6px; }
.flow-step .ftitle { font-weight:700; font-size:13px; margin-bottom:4px; }
.flow-step .fdesc { font-size:11.5px; color:var(--text2); line-height:1.5; }

.flow-step.bad { background:var(--red-light); border-color:var(--red-border); }
.flow-step.bad .ftitle { color:var(--red); }
.flow-step.good { background:var(--green-light); border-color:var(--green-border); }
.flow-step.good .ftitle { color:var(--green); }

.flow-arrow { font-size:20px; color:var(--border2); flex-shrink:0; }
.flow-arrow.bad-arrow { color:var(--red); }
.flow-arrow.good-arrow { color:var(--green); }

/* Defense box */
.defense {
  background:var(--green-light); border:1px solid var(--green-border); border-radius:14px;
  padding:22px 26px; position:relative;
}
.defense::before {
  content:'üõ°Ô∏è'; position:absolute; top:-12px; left:20px;
  font-size:20px; background:var(--green-light); padding:0 6px;
}
.defense .label {
  font-family:var(--mono); font-size:10px; letter-spacing:1.5px; text-transform:uppercase;
  color:var(--green); margin-bottom:8px; font-weight:600;
}
.defense p { font-size:14.5px; color:var(--text); line-height:1.75; }
.defense code {
  font-family:var(--mono); font-size:12px; background:rgba(42,157,110,0.1);
  padding:2px 7px; border-radius:4px; color:var(--green);
}

/* Comparison strip */
.vs-strip {
  display:grid; grid-template-columns:1fr auto 1fr; gap:12px; align-items:center;
  margin:20px 0;
}
.vs-card {
  border-radius:12px; padding:18px 20px; text-align:center;
}
.vs-card.attack-card { background:var(--red-light); border:1px solid var(--red-border); }
.vs-card.defend-card { background:var(--green-light); border:1px solid var(--green-border); }
.vs-card .vc-icon { font-size:32px; margin-bottom:8px; }
.vs-card .vc-title { font-weight:700; font-size:14px; margin-bottom:4px; }
.vs-card .vc-desc { font-size:12px; color:var(--text2); line-height:1.5; }
.vs-divider {
  font-family:var(--serif); font-size:18px; font-weight:700; color:var(--text3);
}

/* Recap at bottom */
.recap {
  background:var(--surface); border:1px solid var(--border); border-radius:16px;
  padding:32px; margin-top:48px;
}
.recap h2 {
  font-family:var(--serif); font-size:22px; font-weight:700; margin-bottom:20px;
  text-align:center;
}
.recap-grid {
  display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:14px;
}
.recap-item {
  padding:16px; border-radius:12px; border:1px solid var(--border);
}
.recap-item .ri-icon { font-size:24px; margin-bottom:8px; }
.recap-item .ri-attack { font-weight:700; font-size:14px; margin-bottom:4px; }
.recap-item .ri-analogy { font-size:12.5px; color:var(--text2); line-height:1.6; }
.recap-item .ri-defense {
  font-family:var(--mono); font-size:11px; color:var(--green); margin-top:8px;
  padding:4px 10px; background:var(--green-light); border-radius:6px; display:inline-block;
}

@media(max-width:600px) {
  .flow { flex-direction:column; }
  .flow-arrow { transform:rotate(90deg); }
  .vs-strip { grid-template-columns:1fr; }
  .vs-divider { text-align:center; }
}
</style>
</head>
<body>
<div class="page">

<div class="hero">
  <div class="eyebrow">A Plain-English Guide</div>
  <h1>How Hackers <em>Hijack</em> Programs<br>&amp; How CFI Stops Them</h1>
  <p class="intro">Programs follow instructions like a recipe. Attackers try to make the program skip steps, go to the wrong page, or follow a fake recipe entirely. Here's how each attack works ‚Äî no jargon required.</p>
</div>

<!-- ============ ATTACK 1: Buffer Overflow + ROP ============ -->
<div class="attack-section">
  <div class="section-num">Attack 01</div>
  <h2><span class="emoji">üì¶</span> The Overflowing Box</h2>
  <div class="aka">Technical name: Buffer Overflow ‚Üí Return-Oriented Programming (ROP)</div>

  <div class="story">
    Every function in a program keeps a little <strong>note to itself</strong>: "when I'm done, go back to line 42 in main." That note ‚Äî the <strong>return address</strong> ‚Äî sits on a shelf (the stack) right next to a box where incoming data is stored. The problem? <strong>The box has a fixed size, but nobody checks if you're putting too much in it.</strong>
  </div>

  <div class="analogy">
    <div class="label">Real-World Analogy</div>
    <p>Imagine a post office with numbered mailboxes. Your return-home address is in box #5. An attacker sends a package so big it <strong>spills out of box #1 and overwrites box #5</strong> with a fake address. Now when you try to "go home," you end up at the attacker's house instead.</p>
  </div>

  <div class="scene">
    <div class="scene-header">
      <div class="scene-dot" style="background:var(--red)"></div>
      <div class="scene-dot" style="background:var(--amber)"></div>
      <div class="scene-dot" style="background:var(--green)"></div>
    </div>
    <div class="scene-body">
      <div class="flow">
        <div class="flow-step">
          <div class="icon">üì•</div>
          <div class="ftitle">Data arrives</div>
          <div class="fdesc">Program reads user input into a small buffer</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üí•</div>
          <div class="ftitle">Overflow!</div>
          <div class="fdesc">Input is way too big ‚Äî spills past the buffer</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üìù</div>
          <div class="ftitle">Note rewritten</div>
          <div class="fdesc">Return address overwritten with attacker's address</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üèöÔ∏è</div>
          <div class="ftitle">Wrong "home"</div>
          <div class="fdesc">Program returns to attacker's code instead of its own</div>
        </div>
      </div>
    </div>
  </div>

  <div class="defense">
    <div class="label">How CFI stops this ‚Äî Shadow Stack (Zicfiss)</div>
    <p>The CPU keeps a <strong>secret second copy</strong> of the return address in a locked safe (the shadow stack). When the function finishes, it checks: does the note on the shelf match the one in the safe? If the attacker changed the shelf copy, it <strong>won't match the safe</strong> ‚Äî and the program stops immediately instead of going to the wrong place.</p>
  </div>
</div>

<!-- ============ ATTACK 2: JOP ============ -->
<div class="attack-section">
  <div class="section-num">Attack 02</div>
  <h2><span class="emoji">üîÄ</span> The Fake Signpost</h2>
  <div class="aka">Technical name: Jump-Oriented Programming (JOP)</div>

  <div class="story">
    Programs sometimes need to decide at runtime <strong>which function to call</strong> ‚Äî like a GPS choosing a route. The destination is stored in a <strong>function pointer</strong> ‚Äî essentially a signpost saying "go to function X." If an attacker can change that signpost, the program <strong>takes a wrong turn</strong> and ends up executing attacker-chosen code.
  </div>

  <div class="analogy">
    <div class="label">Real-World Analogy</div>
    <p>You're driving and following road signs to "City Hall." Overnight, someone <strong>swapped the sign</strong> to point toward an abandoned warehouse. You follow it trusting the sign ‚Äî and end up somewhere you never intended to go.</p>
  </div>

  <div class="scene">
    <div class="scene-header">
      <div class="scene-dot" style="background:var(--red)"></div>
      <div class="scene-dot" style="background:var(--amber)"></div>
      <div class="scene-dot" style="background:var(--green)"></div>
    </div>
    <div class="scene-body">
      <div class="flow">
        <div class="flow-step">
          <div class="icon">ü™ß</div>
          <div class="ftitle">Signpost exists</div>
          <div class="fdesc">Function pointer says "go to process_data()"</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üîß</div>
          <div class="ftitle">Sign swapped</div>
          <div class="fdesc">Attacker corrupts pointer to aim at their code</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üèöÔ∏è</div>
          <div class="ftitle">Wrong destination</div>
          <div class="fdesc">Program jumps to middle of unrelated code</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üëæ</div>
          <div class="ftitle">Attacker wins</div>
          <div class="fdesc">Chains small code snippets to do anything they want</div>
        </div>
      </div>
    </div>
  </div>

  <div class="defense">
    <div class="label">How CFI stops this ‚Äî Landing Pads (Zicfilp)</div>
    <p>Every legitimate function starts with a <strong>special welcome mat</strong> (the <code>lpad</code> instruction). When the program follows a signpost, the CPU checks: is there a welcome mat at the destination? If the attacker redirected to the <strong>middle</strong> of some code (no welcome mat), the CPU says <strong>"this isn't a real entrance"</strong> and refuses to continue.</p>
  </div>
</div>

<!-- ============ ATTACK 3: Type Confusion ============ -->
<div class="attack-section">
  <div class="section-num">Attack 03</div>
  <h2><span class="emoji">üé≠</span> The Impostor Function</h2>
  <div class="aka">Technical name: Type Confusion / Signature Mismatch</div>

  <div class="story">
    In the kernel (the core of your operating system), different drivers and modules register <strong>callback functions</strong> ‚Äî like putting your phone number on a sign-up sheet so the system can call you when it's your turn. But what if an attacker <strong>replaces your phone number with someone else's</strong> ‚Äî a function that does something completely different but still technically "answers the phone"?
  </div>

  <div class="analogy">
    <div class="label">Real-World Analogy</div>
    <p>A hospital has a list of on-call doctors by specialty. An attacker swaps the phone number for "heart surgeon" with the number for "janitor." When there's a cardiac emergency, the hospital calls the janitor thinking they're reaching the surgeon. <strong>The phone rings either way ‚Äî but the wrong person answers.</strong></p>
  </div>

  <div class="scene">
    <div class="scene-header">
      <div class="scene-dot" style="background:var(--red)"></div>
      <div class="scene-dot" style="background:var(--amber)"></div>
      <div class="scene-dot" style="background:var(--green)"></div>
    </div>
    <div class="scene-body">
      <div class="flow">
        <div class="flow-step">
          <div class="icon">üìã</div>
          <div class="ftitle">Callback list</div>
          <div class="fdesc">Kernel stores: "on read, call read_handler()"</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üé≠</div>
          <div class="ftitle">Pointer swapped</div>
          <div class="fdesc">Attacker replaces it with a different function</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üìû</div>
          <div class="ftitle">Wrong answer</div>
          <div class="fdesc">Kernel calls the impostor thinking it's legit</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üîì</div>
          <div class="ftitle">Escalation</div>
          <div class="fdesc">Impostor function gives attacker kernel access</div>
        </div>
      </div>
    </div>
  </div>

  <div class="defense">
    <div class="label">How CFI stops this ‚Äî Type Hash (kCFI)</div>
    <p>Every function gets a <strong>secret ID badge</strong> (a type hash) based on its signature ‚Äî what inputs it takes and what it returns. Before calling any function pointer, the kernel checks: <strong>"does this function's ID badge match what I'm expecting?"</strong> A read handler has a different badge than a write handler. The impostor's badge won't match, and the call is blocked.</p>
  </div>
</div>

<!-- ============ ATTACK 4: Stack Smash ============ -->
<div class="attack-section">
  <div class="section-num">Attack 04</div>
  <h2><span class="emoji">üß±</span> The Collapsing Tower</h2>
  <div class="aka">Technical name: Stack Smashing / Stack Corruption</div>

  <div class="story">
    The program stack is like a <strong>tower of neatly stacked boxes</strong>. Each function call adds a new box on top with its own local data and return note. A stack-smashing attack intentionally <strong>knocks the tower sideways</strong> ‚Äî corrupting not just one box, but everything above and below it. The saved registers, the frame pointers, the return addresses ‚Äî all scrambled.
  </div>

  <div class="analogy">
    <div class="label">Real-World Analogy</div>
    <p>Picture a filing cabinet where each drawer is a different function's workspace. An attacker <strong>yanks one drawer out so hard</strong> that all the other drawers get jumbled ‚Äî papers from "payroll" end up in "security credentials," and when the system tries to read them, it follows whatever nonsense is there.</p>
  </div>

  <div class="scene">
    <div class="scene-header">
      <div class="scene-dot" style="background:var(--red)"></div>
      <div class="scene-dot" style="background:var(--amber)"></div>
      <div class="scene-dot" style="background:var(--green)"></div>
    </div>
    <div class="scene-body">
      <div class="flow">
        <div class="flow-step">
          <div class="icon">üß±</div>
          <div class="ftitle">Clean stack</div>
          <div class="fdesc">Functions neatly stacked ‚Äî return addresses intact</div>
        </div>
        <div class="flow-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üåä</div>
          <div class="ftitle">Flood of data</div>
          <div class="fdesc">Malicious input floods through multiple stack frames</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üèöÔ∏è</div>
          <div class="ftitle">Everything corrupted</div>
          <div class="fdesc">Return addresses, saved regs, locals ‚Äî all trashed</div>
        </div>
        <div class="flow-arrow bad-arrow">‚Üí</div>
        <div class="flow-step bad">
          <div class="icon">üíÄ</div>
          <div class="ftitle">Chain reaction</div>
          <div class="fdesc">Every function return goes somewhere wrong</div>
        </div>
      </div>
    </div>
  </div>

  <div class="defense">
    <div class="label">How CFI stops this ‚Äî Shadow Stack + Canary combo</div>
    <p>Two layers of defense work together. First, the <strong>stack canary</strong> is like a tripwire ‚Äî a secret value placed right before the return address. If the flood of data hits it, the tripwire breaks and the program knows something is wrong. Second, the <strong>shadow stack</strong> (Zicfiss) keeps clean copies of all return addresses in a completely separate, hardware-locked location that the flood <strong>can never reach</strong>.</p>
  </div>
</div>

<!-- ============ RECAP ============ -->
<div class="recap">
  <h2>The Cheat Sheet</h2>
  <div class="recap-grid">
    <div class="recap-item">
      <div class="ri-icon">üì¶</div>
      <div class="ri-attack">Buffer Overflow ‚Üí ROP</div>
      <div class="ri-analogy">Overstuff a mailbox to rewrite the return-home address. Chain small existing code pieces together.</div>
      <div class="ri-defense">üõ° Shadow Stack (Zicfiss)</div>
    </div>
    <div class="recap-item">
      <div class="ri-icon">üîÄ</div>
      <div class="ri-attack">Jump-Oriented (JOP)</div>
      <div class="ri-analogy">Swap a road sign so the program takes a wrong turn to attacker-chosen code.</div>
      <div class="ri-defense">üõ° Landing Pad (Zicfilp)</div>
    </div>
    <div class="recap-item">
      <div class="ri-icon">üé≠</div>
      <div class="ri-attack">Type Confusion</div>
      <div class="ri-analogy">Replace a doctor's phone number with a janitor's ‚Äî the call goes through but the wrong person answers.</div>
      <div class="ri-defense">üõ° Type Hash (kCFI)</div>
    </div>
    <div class="recap-item">
      <div class="ri-icon">üß±</div>
      <div class="ri-attack">Stack Smashing</div>
      <div class="ri-analogy">Yank a filing drawer so hard everything gets jumbled. Every return goes somewhere wrong.</div>
      <div class="ri-defense">üõ° Shadow Stack + Canary</div>
    </div>
  </div>
</div>

</div>
</body>
</html>
